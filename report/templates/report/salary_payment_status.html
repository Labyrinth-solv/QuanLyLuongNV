{% extends "base_admin.html" %}

{% block title %}Bảng theo dõi tình trạng thanh toán của nhân viên{% endblock %}

{% block content %}

    {% if selected_month %}
        <p>Tháng đang xem: {{ selected_month }}</p>
    {% endif %}

    <form method="get">
        <label for="month">Chọn tháng:</label>
        <input type="month" id="month" name="month" value="{{ selected_month|default:'' }}">
        <br>
        <label for="payment_filter">Trạng thái thanh toán:</label>
        <select id="payment_filter" name="payment_filter">
            <option value="" {% if payment_filter == "" %}selected{% endif %}>Tất cả</option>
            <option value="paid" {% if payment_filter == "paid" %}selected{% endif %}>Đã thanh toán</option>
            <option value="unpaid" {% if payment_filter == "unpaid" %}selected{% endif %}>Chưa thanh toán</option>
        </select>

        <label for="staff_name">Tên nhân viên:</label>
        <input type="text" id="staff_name" name="staff_name" value="{{ staff_name|default:'' }}" placeholder="Nhập tên nhân viên">

        <button type="submit">Lọc</button>
    </form>

        <p><strong>Tổng đã thanh toán:</strong> {{ total_paid }}</p>
        <p><strong>Tổng chưa thanh toán:</strong> {{ total_unpaid }}</p>
        <br>

    <table border="1" cellspacing="0" cellpadding="5">
    <thead>
        <tr>
            <th>STT</th>
            <th>Mã ID</th>
            <th>Username</th>
            <th>Cấp bậc</th>
            <th>Lương tạm tính</th>
            <th>Số buổi vắng</th>
            <th>Đã thanh toán</th>
            <th>Chưa thanh toán</th>
        </tr>
    </thead>

    <tbody>
        <!-- Ví dụ dùng Django template -->
        {% for s in staffs %}
        <tr>
            <td>{{ forloop.counter }}</td>
            <td>{{ s.staff_id }}</td>
            <td>{{ s.username }}</td>
            <td>{{ s.rank }}</td>
                {% if s.total_amount %}
            <td>{{ s.total_amount|floatformat:1 }}</td>
                {% else %}
            <td>{{ s.amount|floatformat:1 }}</td>
            {% endif %}
            <td>{{ s.absent }}</td>
            <td>
                {% if s.payment_status %}
                    x
                {% endif %}
            </td>
            <td>
                {% if not s.payment_status %}
                x
                {% endif %}
            </td>
        </tr>
        {% endfor %}
    </tbody>
</table>


{% endblock %}
