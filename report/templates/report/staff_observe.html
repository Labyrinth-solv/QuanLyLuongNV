{% extends "base_staff.html" %}
{% load custom_tags %}
{% block content %}

{% load static %}
<!-- Bootstrap CSS (nếu chưa có) -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css">

<div class="container my-4">
    <h2 class="mb-3">Báo cáo chấm công tháng {{ selected_month }}</h2>
    <p><strong>Nhân viên:</strong> {{ staffs.username }}</p>

    <!-- Tổng số ngày -->
    <div class="d-flex gap-4 mb-3">
        <p><strong>Số ngày đã chấm công:</strong> {{ total_present }}</p>
        <p><strong>Số ngày vắng:</strong> {{ total_absent }}</p>
    </div>

    <!-- Form chọn tháng -->
    <form method="get" class="row g-2 mb-4 align-items-center">
        <div class="col-auto">
            <label for="month" class="col-form-label">Chọn tháng:</label>
        </div>
        <div class="col-auto">
            <input type="month" id="month" name="month" value="{{ selected_month }}" class="form-control">
        </div>
        <div class="col-auto">
            <button type="submit" class="btn btn-primary">Xem</button>
        </div>
    </form>

    <!-- Bảng chấm công -->
    <div class="table-responsive">
        <table class="table table-bordered text-center align-middle">
            <thead class="table-light">
                <tr>
                    <th>Ngày</th>
                    <th>Trạng thái</th>
                    <th>Ngày</th>
                    <th>Trạng thái</th>
                </tr>
            </thead>
            <tbody>
                {% for i in attendance_data|slice:":None"|batch:2 %}
                <tr>
                    {% for day in i %}
                        <td>{{ day.day }}</td>
                        <td>
                            {% if day.status == "chamcong" %}
                                <span class="badge bg-success">✔ Đã chấm công</span>
                            {% elif day.status == "vang" %}
                                <span class="badge bg-danger">✖ Vắng</span>
                            {% else %}
                                <span class="badge bg-warning text-dark">… Chưa chấm công</span>
                            {% endif %}
                        </td>
                    {% endfor %}
                    {% if i|length < 2 %}
                        <td>&nbsp;</td>
                        <td>&nbsp;</td>
                    {% endif %}
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>

{% endblock %}
